prectic sql file

########################################################################
Q1. Employee Table:

 create a table Empl with the following columns:
           EmpNo (int, primary key),
           Fname (char(15)),
           Lname (char(15)),
           DeptNo (int, foreign key referencing Dept(DeptNo)),
           Edulevel (char(15)),
           Jobcode (int),
           salary (int),
           Hiredate (Date);
########################################################################

mysql> create table Empl
(EmpNo int, Fname char(15),
Lname char(15),DeptNo int,
Edulevel char(15),Jobcode int,
salary int,Hiredate Date, primary key(EmpNo),
Foreign key(DeptNo) References Dept(DeptNo));
Query OK, 0 rows affected (0.09 sec)

mysql> desc Empl;
+----------+----------+------+-----+---------+-------+
| Field    | Type     | Null | Key | Default | Extra |
+----------+----------+------+-----+---------+-------+
| EmpNo    | int      | NO   | PRI | NULL    |       |
| Fname    | char(15) | YES  |     | NULL    |       |
| Lname    | char(15) | YES  |     | NULL    |       |
| DeptNo   | int      | YES  | MUL | NULL    |       |
| Edulevel | char(15) | YES  |     | NULL    |       |
| Jobcode  | int      | YES  |     | NULL    |       |
| salary   | int      | YES  |     | NULL    |       |
| Hiredate | date     | YES  |     | NULL    |       |
+----------+----------+------+-----+---------+-------+
8 rows in set (0.05 sec)



mysql> insert into Empl(EmpNo,FName,Lname,DeptNo,Edulevel,Jobcode,Salary,HireDate)
    ->values(10001,'Deepak','Mathew',100,'Degree',1,20000,'2017-05-10');
    -> (10002,'Ashwani','Bouddhist',100,'PG',1,22000,'2016-01-05'),
    -> (10003,'Deepa','Raj',101,'Diploma',3,16000,'2019-01-04'),
    -> (10004,'Divya','Jayan',102,'MBA',2,28000,'2017-10-10');
Query OK, 3 rows affected (0.05 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM EMPL;
+-------+---------+-----------+--------+----------+---------+--------+------------+
| EmpNo | Fname   | Lname     | DeptNo | Edulevel | Jobcode | salary | Hiredate   |
+-------+---------+-----------+--------+----------+---------+--------+------------+
| 10001 | Deepak  | Mathew    |    100 | Degree   |       1 |  20000 | 2017-05-10 |
| 10002 | Ashwani | Bouddhist |    100 | PG       |       1 |  22000 | 2016-01-05 |
| 10003 | Deepa   | Raj       |    101 | Diploma  |       3 |  16000 | 2019-01-04 |
| 10004 | Divya   | Jayan     |    102 | MBA      |       2 |  28000 | 2017-10-10 |
+-------+---------+-----------+--------+----------+---------+--------+------------+
4 rows in set (0.00 sec)

mysql> insert into Empl(EmpNo,FName,Lname,DeptNo,Edulevel,Jobcode,Salary,HireDate)
values(10005,'Karthik','Satyan',102,'MBA',4,30000,'2018-12-01'),
     (10006,'Manu','George',101,'ITI',3,12000,'2016-03-20'),
     (10007,'Amal','Davis',103,'Degree',2,20000,'2017-02-01'),
     (10008,'Sanal','Krishnan',104,'Degree',2,21000,'2016-02-21'),
     (10009,'Kiran','Lal',104,'Degree',2,22000,'2015-02-21'),
     (10010,'Syam','Nair',104,'Degree',2,20000,'2017-02-10');


mysql> SELECT * FROM EMPL;
+-------+---------+-----------+--------+----------+---------+--------+------------+
| EmpNo | Fname   | Lname     | DeptNo | Edulevel | Jobcode | salary | Hiredate   |
+-------+---------+-----------+--------+----------+---------+--------+------------+
| 10001 | Deepak  | Mathew    |    100 | Degree   |       1 |  20000 | 2017-05-10 |
| 10002 | Ashwani | Bouddhist |    100 | PG       |       1 |  22000 | 2016-01-05 |
| 10003 | Deepa   | Raj       |    101 | Diploma  |       3 |  16000 | 2019-01-04 |
| 10004 | Divya   | Jayan     |    102 | MBA      |       2 |  28000 | 2017-10-10 |
| 10005 | Karthik | Satyan    |    102 | MBA      |       4 |  30000 | 2018-12-01 |
| 10006 | Manu    | George    |    101 | ITI      |       3 |  12000 | 2016-03-20 |
| 10007 | Amal    | Davis     |    103 | Degree   |       2 |  20000 | 2017-02-01 |
| 10008 | Sanal   | Krishnan  |    104 | Degree   |       2 |  21000 | 2016-02-21 |
| 10009 | Kiran   | Lal       |    104 | Degree   |       2 |  22000 | 2015-02-21 |
| 10010 | Syam    | Nair      |    104 | Degree   |       2 |  20000 | 2017-02-10 |
+-------+---------+-----------+--------+----------+---------+--------+------------+
10 rows in set (0.00 sec)

########################################################################
########################################################################
Q1. Department Table:
      
    create a table Dept with the following columns:
             DeptNo (int, primary key),
             DeptName (char(10)),
             Location (char(15));
########################################################################
########################################################################
mysql> create table dept(DeptNo int,DeptName char(10),Location char(15),PRIMARY KEY (DeptNo));
Query OK, 0 rows affected (0.25 sec)

mysql> desc dept;
+----------+----------+------+-----+---------+-------+
| Field    | Type     | Null | Key | Default | Extra |
+----------+----------+------+-----+---------+-------+
| DeptNo   | int      | NO   | PRI | NULL    |       |
| DeptName | char(10) | YES  |     | NULL    |       |
| Location | char(15) | YES  |     | NULL    |       |
+----------+----------+------+-----+---------+-------+
3 rows in set (0.09 sec)


########################################################################
########################################################################
mysql> alter table dept 
       modify deptNo int (11);
                                -- Query OK, 

mysql> desc dept;
+----------+----------+------+-----+---------+-------+
| Field    | Type     | Null | Key | Default | Extra |
+----------+----------+------+-----+---------+-------+
| deptNo   | int      | NO   | PRI | NULL    |       |
| DeptName | char(10) | YES  |     | NULL    |       |
| Location | char(15) | YES  |     | NULL    |       |
+----------+----------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> insert into Dept(DeptNo,DeptName,Location)
    -> values(100,'HR','Trivandrum'),
       (101,'Production','Kazhakkoottam'),
       (102,'Marketing','Trivandrum'),
       (103,'Purchase','Trivandrum'),
       (104,'Sales','Attingal');

Query OK, 1 row affected (0.07 sec)

########################################################################
########################################################################
mysql> SELECT * FROM DEPT;
+--------+------------+---------------+
| deptNo | DeptName   | Location      |
+--------+------------+---------------+
|    100 | HR         | Trivandrum    |
|    101 | Production | Kazhakkoottam |
|    102 | Marketing  | Trivandrum    |
|    103 | Purchase   | Trivandrum    |
|    104 | Sales      | Attingal      |
+--------+------------+---------------+
5 rows in set (0.07 sec)

########################################################################
########################################################################



########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################
########################################################################





########################################################################
########################################################################
create table Employee (
    EmpID int PRIMARY KEY,
    EmpName varchar(50),
    DeptID int,
    Salary int,
    JoinDate date);
    mysql> select * from employee_1;
+-------+---------+--------+--------+------------+
| empID | empName | deptID | salary | Join_Date  |
+-------+---------+--------+--------+------------+
|     1 | Ravi    |     10 |  25000 | 2018-06-01 |
|     2 | Suman   |     20 |  30000 | 2019-08-15 |
|     3 | Riya    |     10 |  27000 | 2020-01-10 |
|     4 | Karan   |     30 |  22000 | 2021-03-12 |
|     5 | Anu     |     20 |  28000 | 2022-07-20 |
+-------+---------+--------+--------+------------+

########################################################################
########################################################################

    mysql> select e.empName,d.dept_name
    -> from employee_1 e
    -> inner join department d
    -> on e.deptID = d.deptID;
+---------+-----------+
| empName | dept_name |
+---------+-----------+
| Ravi    | sales     |
| Suman   | HR        |
| Riya    | sales     |
| Karan   | IT        |
| Anu     | HR        |
+---------+-----------+

########################################################################
########################################################################

mysql> select e.empName,d.dept_name
    -> from employee_1 e
    -> left join department d
    -> on e.deptID = d.deptID;
+---------+-----------+
| empName | dept_name |
+---------+-----------+
| Ravi    | sales     |
| Suman   | HR        |
| Riya    | sales     |
| Karan   | IT        |
| Anu     | HR        |
+---------+-----------+

########################################################################
########################################################################
mysql> select sum(salary) as Total_salary
    -> from employee_1
    -> group by deptID;
+--------------+
| Total_salary |
+--------------+
|        52000 |
|        58000 |
|        22000 |
+--------------+

########################################################################
########################################################################
mysql> select avg(salary) As Average_Salary
    -> from employee_1
    -> group by deptID;
+----------------+
| Average_Salary |
+----------------+
|     26000.0000 |
|     29000.0000 |
|     22000.0000 |
+----------------+
3 rows in set (0.04 sec)

########################################################################
########################################################################
mysql> select sum(salary) as Total_salary
    -> from employee_1
    -> group by deptID having total_salary > 50000;
+--------------+
| Total_salary |
+--------------+
|        52000 |
|        58000 |
+--------------+

########################################################################
########################################################################
mysql> SELECT deptID, COUNT(empID) AS Emp_Count
    -> FROM employee_1
    -> GROUP BY deptID
    -> HAVING COUNT(empID) > 1;
+--------+-----------+
| deptID | Emp_Count |
+--------+-----------+
|     10 |         2 |
|     20 |         2 |
+--------+-----------+
2 rows in set (0.05 sec)

########################################################################
########################################################################
mysql> SELECT MIN(empName) AS empName, deptID, COUNT(empID) AS Emp_Count
    -> FROM employee_1
    -> GROUP BY deptID
    -> HAVING COUNT(empID) > 1;
+---------+--------+-----------+
| empName | deptID | Emp_Count |
+---------+--------+-----------+
| Ravi    |     10 |         2 |
| Anu     |     20 |         2 |
+---------+--------+-----------+
2 rows in set (0.01 sec)

########################################################################
########################################################################
mysql> select empname,salary
    -> from employee_1
    -> where salary > 27000;
+---------+--------+
| empname | salary |
+---------+--------+
| Suman   |  30000 |
| Anu     |  28000 |
+---------+--------+
2 rows in set (0.07 sec)

########################################################################
########################################################################
mysql> SELECT empname
    -> FROM employee_1
    -> WHERE deptID = (
    ->     SELECT deptID
    ->     FROM department
    ->     WHERE dept_name = 'sales'
    -> );
+---------+
| empname |
+---------+
| Ravi    |
| Riya    |
+---------+

########################################################################
########################################################################
mysql> select dept_name from department where deptid in (select deptid from employee_1 where salary > 28000);
+-----------+
| dept_name |
+-----------+
| HR        |
+-----------+
1 row in set (0.05 sec)


########################################################################
########################################################################
mysql> SELECT d.dept_name, SUM(e.salary) AS total_salary
    -> FROM employee_1 e
    -> JOIN department d ON e.deptid = d.deptid
    -> WHERE e.join_date > '2019-01-01'
    -> GROUP BY d.dept_name
    -> HAVING SUM(e.salary) > 50000;
+-----------+--------------+
| dept_name | total_salary |
+-----------+--------------+
| HR        |        58000 |
+-----------+--------------+
1 row in set (0.02 sec)

########################################################################
########################################################################


########################################################################
########################################################################